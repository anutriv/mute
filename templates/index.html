<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mute Video Sections</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 50px; }
        input { margin: 10px; }
        button { padding: 10px; cursor: pointer; }
        #download { display: none; }
    </style>
</head>
<body>

    <h2>Upload MP4 and Timestamp File</h2>
    <input type="file" id="videoFile" accept="video/mp4">
    <input type="file" id="timestampsFile" accept=".txt">
    <br>
    <button onclick="uploadFiles()">Upload Files</button>
    <button id="processButton" onclick="processVideo()" style="display:none;">Get Muted Video</button>
    <br>
    <a id="download" href="#" download="output.mp4">Download Muted Video</a>

    <script>
        const renderURL = "https://your-render-app-url/upload";  // Replace with your Render Flask URL
        let uploaded = false;

        function uploadFiles() {
            let video = document.getElementById("videoFile").files[0];
            let timestamps = document.getElementById("timestampsFile").files[0];

            if (!video || !timestamps) {
                alert("Please select both files.");
                return;
            }

            let formData = new FormData();
            formData.append("video", video, "input.mp4");  // Rename video file
            formData.append("timestamps", timestamps, "timestamps.txt");  // Rename timestamps file

            fetch(renderURL, { method: "POST", body: formData })
            .then(response => {
                if (response.ok) {
                    alert("Files uploaded successfully!");
                    uploaded = true;
                    document.getElementById("processButton").style.display = "inline";
                } else {
                    alert("Upload failed.");
                }
            })
            .catch(error => alert("Error uploading files: " + error));
        }

        function processVideo() {
            if (!uploaded) {
                alert("Upload files first.");
                return;
            }

            fetch(renderURL.replace("/upload", "/process"))  // Replace with your Render Flask process endpoint
            .then(response => response.blob())
            .then(blob => {
                let url = URL.createObjectURL(blob);
                document.getElementById("download").href = url;
                document.getElementById("download").style.display = "inline";
                alert("Muted video is ready for download!");
            })
            .catch(error => alert("Error processing video: " + error));
        }
    </script>

</body>
</html>
